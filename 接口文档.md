# API Documentation {#top}

[User API](#user)
[Config API](#config)
[Auth API](#auth)
[Store API](#store)

## User {#user}

[go top](#top)

## Config {#config}

[go top](#top)

### add regions (with auth)

``` js
{
  url: 'region',
  method: 'post',
  param: {
    name, // string [5, 20] no duplicates 
  },
  return_ok: {
    code: 201,
    msg: 'ok',
  },
  return_fail: {
    code: errCode.REGION_FAILURE,
    msg: 'Duplicate regions!',
  }
}
```

### get regions

``` js
{
  url: 'regions',
  method: 'get',
  return_ok: {
    code: 200,
    data: [
      {
        name, // string
        id, // int
      }
    ]
  },
  return_fail: {
    code: errCode.REGION_FAILURE,
    msg: 'Duplicate regions!',
  }
}
```

### get states

``` js
// if region_id is not null, search by region_id
// else return all states
{
  url: 'states',
  method: 'get',
  param: {
    region_id, // int allowNull
  }
  return_ok: {
    code: 200,
    data: [
      {
        name, //string
        id, // int
        region_id, // int
      }
    ]
  },
  return_fail: {
    code: errCode.STATE_FAILURE,
    msg: 'can\'t get states',
  }
}
```

### get stores

### get business types

``` js
// if region_id is not null, search by region_id
// else return all states
{
  url: 'businessTypes',
  method: 'get',
  return_ok: {
    code: 200,
    data: [
      {
        name, // string
        type, // int
      }
    ]
  },
  return_fail: {
    code: errCode.STATE_FAILURE,
    msg: 'can\'t get states',
  }
}
```

## Add Staff

``` js
{
  url: '/staff'
  method: 'post',
  param: {
    name, // string [3, 15]
    job_title, // int 1 - salesperson 2 - store manager 3 - region manager, required, can only have 3 values
    store_assigned, // int required
    region_assigned, // int required
    salary, // bigint 100 = 1 rmb
  },
  return_ok: {
    code: 201,
    msg: 'User Created!'
  },
  return_fail: {
    code: errCode.REGISTRATION_FAILURE,
    msg: 'User Failure'
  }
}
```

## Auth {#auth}

[go top](#top)

### register

``` js
{
  url: '/account'
  method: 'post',
  param: {
    username, // string [3, 15]
    password, // string [6, 20]
    role_id, // int 1-home 2-business 99-admin
    ... // extra params required, see below
  },
  return_ok: {
    code: 201,
    msg: 'User Created!'
  },
  return_fail: {
    code: errCode.REGISTRATION_FAILURE,
    msg: 'User Failure'
  }
}
// if role_id is 1, extra params needed below
{
  marriage_status, // int 0-single 1-married 2-divorced
  gender, // int 0-male 1-female 2-NA
  birth, // int 10 digit timestamp
  annual_income, // bigint, 1 rmb = 100, last two digits are decimals
  street, // string [1, 30]
  city, // string [1, 20]
  state_id, // int provided by server end, see api get '/states' 
  zip_code, // int length = 5
  uid, // int
}
// if role_id is 2, extra params needed below
{
  annual_income, // bigint, 1 rmb = 100, last two digits are decimals
  street, // string [1, 30]
  city, // string [1, 20]
  state_id, // int provided by server end, see api get '/states'
  zip_code, // int length = 5
  cate, // string provided by server end, see api get 'businessCate'
  uid, // int
}
// if role_id is 99, extra params needed below
{
  name, // string [1, 10]
  uid, // int
}
```

### Login

``` js
{
  url: '/login',
  method: 'post',
  param: {
    username, // string [3, 15]
    password, // string [6, 20]
  },
  return_ok: {
    code: 200,
    token, // string store login status
    data: {
      uid, // int user id
      name, // string
      role, // int
      auth: [1, 2], // int[]
      ... // extra attributes, see below
    }
  },
  return_fail: {
    code: errCode.LOGIN_FAILURE,
    msg: 'login failure'
  },

  // if home user
  {
    marriage_status, // int 0-single 1-married 2-divorced
    gender, // int 0-male 1-female 2-NA
    age, // int [0, 200]
    annual_income, // bigint, 1 rmb = 100, last two digits are decimals
    street, // string [1, 30]
    city, // string [1, 20]
    state_id, // int provided by server end, see api get '/states'
    zip_code, // int length = 5
  }
  // if business user
  {
    annual_income, // bigint, 1 rmb = 100, last two digits are decimals
    street, // string [1, 30]
    city, // string [1, 20]
    state_id, // int provided by server end, see api get '/states'
    zip_code, // int length = 5
    cate, // string provided by server end, see api get 'businessCate'
  }
}
```

## Store {#store}

[go top](#top)

### Add Store

``` js
{
  url: 'store',
  method: 'post',
  param: {
    manager_id // int // staff_id, allow null
    region_id, // int
    name, // string [3, 20] name cannot be duplicated within one region
    street, // string [1, 30]
    city, // string [1, 20]
    state_id, // string provided by server end, see api get '/states'
    zip_code, // int length = 5
  },
  return_ok: {
    code: 201,
    msg: 'success',
  },
  return_fail: {
    code: errCode.STORE_FAILURE,
    msg: 'error when creating store',
  },
}
```

### get stores